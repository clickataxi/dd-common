/*
 * dd-common
 * http://clickataxi.github.io/dd-common/

 * Version: 0.1.0 - 2015-09-09
 * License: MIT
 */
angular.module("dd.common",["dd.common.appState","dd.common.growler","dd.common.interceptors.alertsInterceptor","dd.common.interceptors.busyInterceptor","dd.common.interceptors"]),angular.module("dd.common.appState",[]),angular.module("dd.common.appState").service("appState",[function(){var a=!1;this.isBusy=function(){return a},this.setBusy=function(b){a=b}}]),angular.module("dd.common.growler",["angular-growl"]),angular.module("dd.common.growler").service("growler",["growl",function(a){function b(a){if(d&&d.length){if(!a)return angular.forEach(d,function(a){a&&a.destroy&&a.destroy()}),void d.splice(0,alert.length);for(var b=0;b<d.length;b++)d[b].severity==a&&(d[b].destroy(),d.splice(b--,1))}}function c(b,c,e){var f=a[c](b,e);f&&(e&&e.isPermanent||d.push(f))}var d=[];this.error=function(a,b){c(a,"error",b)},this.success=function(a,b){c(a,"success",b)},this.info=function(a,b){c(a,"info",b)},this.warning=function(a,b){c(a,"warning",b)},this.clearErrors=function(){b("error")},this.clearSuccesses=function(){b("success")},this.clearInfos=function(){b("info")},this.clearWarnings=function(){b("warning")},this.clearAll=function(){b()}}]),angular.module("dd.common.interceptors.alertsInterceptor",["dd.common.growler"]),angular.module("dd.common.interceptors.alertsInterceptor").factory("alertsInterceptor",["$q","growler",function(a,b){return{request:function(c){return c&&c.showErrors&&b.clearErrors(),c||a.when(c)},responseError:function(c){var d=c.data&&(c.data.systemMessage||c.data.message||c.data.Message)||"Unhandled exception occurred.";return c&&c.config&&c.config.showErrors&&(404!==c.status||"GET"!==c.config.method)&&(angular.element("[growl][reference=modal]").length?b.error(d,{referenceId:"modal"}):b.error(d)),a.reject(c)}}}]),angular.module("dd.common.interceptors.busyInterceptor",["dd.common.appState"]),angular.module("dd.common.interceptors.busyInterceptor").factory("busyInterceptor",["$q","appState",function(a,b){return{request:function(c){return c&&c.controlBusyState&&b.setBusy(!0),c||a.when(c)},response:function(c){return c&&c.config&&c.config.controlBusyState&&b.setBusy(!1),c||a.when(c)},responseError:function(c){return c&&c.config&&c.config.controlBusyState&&b.setBusy(!1),a.reject(c)}}}]),angular.module("dd.common.interceptors",["dd.common.interceptors.alertsInterceptor","dd.common.interceptors.busyInterceptor"]);