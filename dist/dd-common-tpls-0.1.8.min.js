/*
 * dd-common
 * http://clickataxi.github.io/dd-common/

 * Version: 0.1.8 - 2016-08-22
 * License: MIT
 */
angular.module("dd.common",["dd.common.tpls","dd.common.appState","dd.common.growler","dd.common.interceptors.alertsInterceptor","dd.common.interceptors.busyInterceptor","dd.common.interceptors.corsAuthInterceptor","dd.common.interceptors"]),angular.module("dd.common.tpls",[]),angular.module("dd.common.appState",[]),angular.module("dd.common.appState").service("appState",[function(){var a=!1;this.isBusy=function(){return a},this.setBusy=function(b){a=b}}]),angular.module("dd.common.growler",["angular-growl"]),angular.module("dd.common.growler").service("growler",["growl",function(a){function b(a){if(e&&e.length){if(!a)return angular.forEach(e,function(a){c(a)}),void e.splice(0,alert.length);for(var b=0;b<e.length;b++)e[b].severity===a&&(c(e[b]),e.splice(b--,1))}}function c(a){try{a.destroy()}catch(b){}}function d(b,c,d){var f=a[c](b,d);d&&d.isPermanent||f&&e.push(f)}var e=[];this.error=function(a,b){d(a,"error",b)},this.success=function(a,b){d(a,"success",b)},this.info=function(a,b){d(a,"info",b)},this.warning=function(a,b){d(a,"warning",b)},this.clearErrors=function(){b("error")},this.clearSuccesses=function(){b("success")},this.clearInfos=function(){b("info")},this.clearWarnings=function(){b("warning")},this.clearAll=function(){b()}}]),angular.module("dd.common.interceptors.alertsInterceptor",["dd.common.growler"]),angular.module("dd.common.interceptors.alertsInterceptor").factory("alertsInterceptor",["$q","growler",function(a,b){return{request:function(c){return c&&c.ignoreErrors!==!0&&b.clearErrors(),c||a.when(c)},responseError:function(c){if(c.config&&c.config.ignoreErrors!==!0&&(404!==c.status||"GET"!==c.config.method)&&!(c.status<=0&&c.config.timeout)){var d=c.status>0?c.data&&(c.data.message||c.data.Message||c.data.systemMessage)||"Unhandled error occurred.":"Network connection error.";angular.element(".modal.in [growl][reference=modal]").length?b.error(d,{referenceId:"modal"}):b.error(d)}return a.reject(c)}}}]),angular.module("dd.common.interceptors.busyInterceptor",["dd.common.appState"]),angular.module("dd.common.interceptors.busyInterceptor").factory("busyInterceptor",["$q","appState",function(a,b){return{request:function(c){return c&&c.controlBusyState&&b.setBusy(!0),c||a.when(c)},response:function(c){return c&&c.config&&c.config.controlBusyState&&b.setBusy(!1),c||a.when(c)},responseError:function(c){return c&&c.config&&c.config.controlBusyState&&b.setBusy(!1),a.reject(c)}}}]),angular.module("dd.common.interceptors.corsAuthInterceptor",["ngCookies"]),angular.module("dd.common.interceptors.corsAuthInterceptor").factory("corsAuthInterceptor",["$window","$cookies",function(a,b){return{request:function(c){var d=c.url.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i),e=d&&d[1];if(e&&a.location.host!==e&&e.startsWith("admin")&&e.endsWith("drivr.com")&&!c.headers.Authorization){var f=b.get(".ASPXAUTH");f&&(c.headers.Authorization=f)}return c}}}]),angular.module("dd.common.interceptors",["dd.common.interceptors.alertsInterceptor","dd.common.interceptors.busyInterceptor","dd.common.interceptors.corsAuthInterceptor"]);